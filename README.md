# Hana
A [Sana](https://nvlabs.github.io/Sana/)-like diffusion model

<div align="center" border-radius="10px">
  <img src="assets/hana_logo_small.png" width="60%"/>
</div>

## WIP 

| Model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Text Encoder | AE | Transformer | Dataset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Compute | Model | Code | Loss | Samples&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
| ----------- | ----------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| Alpha-8d    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>400 epochs,<br/>BS 896,<br/>**1000** timesteps                                       | 1x4090, 6.2hrs  | [Model](https://huggingface.co/g-ronimo/hana-small_alpha8_TS-1000_400e)  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8d)      | [1.14](https://github.com/geronimi73/Hana/tree/main/Alpha-8d/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/zosah03p)    ![loss_comparison](https://github.com/user-attachments/assets/0b0abffd-b71d-4daf-99ad-cb16a4f08064)    | ![media_images_images_eval_1463_2941cfe11fbe584e6130](https://github.com/user-attachments/assets/5ad9adb8-5735-4372-a789-58b487ff3ce1)
| Alpha-8c    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>236 epochs,<br/>BS 896,<br/>**40** timesteps                                         | 1x4090, 2.6hrs  | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8c)      | [1.33](https://github.com/geronimi73/Hana/tree/main/Alpha-8c/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/btbeqql9)           | ![media_images_images_eval_858_39143ae078839e67f230 (1)](https://github.com/user-attachments/assets/6affe478-1d58-4930-bf57-5efb72e262f6)
| Alpha-8b    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>250 epochs,<br/>BS 896,<br/>**20** timesteps                                         | 1x4090, 2.6hrs  | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8b)      | [1.33](https://github.com/geronimi73/Hana/tree/main/Alpha-8b/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/uddo10fr)           | ![media_images_images_eval_891_65d6f480d656633d9ff8](https://github.com/user-attachments/assets/fde04355-8e74-473b-809f-a2afc2102aa7)
| Alpha-8a    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>250 epochs,<br/>BS 896,<br/>10 timesteps                                             | 1x4090, 2.6hrs  | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8a)      | [1.34](https://github.com/geronimi73/Hana/tree/main/Alpha-8a/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/clwvgpf7)           | ![media_images_images_eval_914_984ebb3d40cd269bf7f2](https://github.com/user-attachments/assets/73962aa2-1ef2-48ce-bbbd-32dfd096d1b0)
| Alpha-7     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>3 epochs,<br/>BS 256                                         | 1x4090, 10'     | [Model](https://huggingface.co/g-ronimo/hana-small_alpha7)               | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-7)       | [0.99](https://wandb.ai/g-ronimo/Hana/runs/clwvgpf7)                          | ![media_images_images_eval_41_f15cda102f6f1ed8ee3b](https://github.com/user-attachments/assets/3deee877-710b-432e-b7f7-985384586b94)
| Alpha-5     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [Imagenet-1k](https://huggingface.co/datasets/g-ronimo/Imagenet-256-latents_dc-ae-f32c32-sana-1.0) <br/>20 epochs,<br/>BS 128                           | 1x4090, 22hrs   | FAIL                                                                     | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-5)       | diverging after e2 [2.57](https://wandb.ai/g-ronimo/Hana/runs/vtpys2tl)       | ![media_images_images_eval_11065_a98b1c9fd31b90e95541](https://github.com/user-attachments/assets/8941d2be-f5e4-4476-8947-b5f909ed41f4)
| Alpha-4     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>3 epochs,<br/>BS 128                                         | 1x4090, 9'      | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-MODERNBERT-3e)  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-4)       | [1.050](https://wandb.ai/g-ronimo/Hana/runs/c2io87nu)                         | ![media_images_images_eval_76_61a68bef7c70a802ced5](https://github.com/user-attachments/assets/cfd92ec1-d4fe-49c6-9726-0dfe6cb6c8a3)
| Alpha-3     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>85660 steps,=150 epochs,<br/>BS 128                          | 1x4090, 8 hrs   | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-MODERNBERT)     | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-3)       | [0.833](https://wandb.ai/g-ronimo/Hana/runs/nahswxbq)                         | ![media_images_images_eval_670_f1a015427c67c3e5933e](https://github.com/user-attachments/assets/3bd1dade-69c4-4b52-8725-66fbd3e9dce6)
| Alpha-2     | [Gemma2 2b](https://huggingface.co/google/gemma-2-2b)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) 7 layers instead of 28            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/> 7940 steps,<br/>BS 128                                                                          | 1x4090, 40'     | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-BATCHED)        | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-2)       | [0.933](https://wandb.ai/g-ronimo/Hana/runs/wbxx3k1y)                         | ![images_eval_406_016a491efda29b0ea833](https://github.com/user-attachments/assets/8b367260-3a78-47a0-b6ce-65c95aee78fe)
| Alpha-1     | [Gemma2 2b](https://huggingface.co/google/gemma-2-2b)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) 7 layers instead of 28            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/> 5 epochs,<br/>LR 1e-4,<br/>300k steps,<br/>BS 1                                                 | 1x4090, 4 hours | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-5e)             | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-1)       | [0.958](https://wandb.ai/g-ronimo/Hana/runs/zf38z5gx)                         | ![images_eval_15565_b120cf6385fa11612684](https://github.com/user-attachments/assets/96cc0930-47f7-4dfd-aeec-f8f361e75466)















