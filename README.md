# Hana
~~A [Sana](https://nvlabs.github.io/Sana/)-like diffusion model~~

I have no idea what I am doing and that's why I do it


<div align="center" border-radius="10px">
  <img src="assets/hana_logo_small.png" width="60%"/>
</div>

## WIP 


| Model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Text Encoder | AE | Transformer | Dataset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Compute | Model | Code | Loss | Samples&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
| ----------- | ----------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --------------- | ------------------------------------------------------------------------------- | ------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| Alpha-15    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [CIFAR10 128px](https://huggingface.co/datasets/g-ronimo/CIFAR10-128-latents_dc-ae-f32c32-sana-1.0) <br/>800 epochs,<br/>BS 512,<br/>1000 timesteps,<br/>LR 5e-4                            | 3x3090 8.5hrs   | forgot to save                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-15)      | [0.78](https://wandb.ai/g-ronimo/Hana/runs/av83k8z6)   ![loss](https://github.com/user-attachments/assets/fe0af49c-98dd-4784-979e-8b477803e544)                                                                                        | ![eval_images](https://github.com/user-attachments/assets/da8545cc-6b93-449f-a548-db92c2d8cc9e)
| Alpha-14    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [CIFAR10 128px](https://huggingface.co/datasets/g-ronimo/CIFAR10-128-latents_dc-ae-f32c32-sana-1.0) <br/>1000 epochs,<br/>BS 384,<br/>1000 timesteps,<br/>LR 5e-4, **scalingf fix**         | 1x3090, 23hrs   | [Model](https://huggingface.co/g-ronimo/hana-alpha14_cifar10-128_TS-1000_1000e) | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-14)      | [0.78](https://wandb.ai/g-ronimo/Hana/runs/yx94vzpn)   ![W B Chart 2_6_2025, 7_15_45 AM](https://github.com/user-attachments/assets/78380b91-f85c-4b23-9e89-235d7aefe02e)                                                              | ![gallery](https://github.com/user-attachments/assets/fb8c6223-5033-4553-8a33-34cb73087e1a)
| Alpha-13    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [CIFAR10 128px](https://huggingface.co/datasets/g-ronimo/CIFAR10-128-latents_dc-ae-f32c32-sana-1.0) <br/>1000 epochs,<br/>BS 384,<br/>1000 timesteps,<br/>LR 5e-4                           | 1x3090, 23hrs   | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-13)   | [1.9](https://wandb.ai/g-ronimo/Hana/runs/gey67vx1)    ![W B Chart 2_4_2025, 9_11_30 PM](https://github.com/user-attachments/assets/822165b5-4361-4c44-b295-4520988ae72f)                                                          | ![media_images_images_eval_127_4ac141f8512cc0ee4592](https://github.com/user-attachments/assets/3cdda8af-6ae3-4431-aafd-c0a36e58c07d)
| Alpha-12    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [CIFAR10 64px](https://huggingface.co/datasets/g-ronimo/CIFAR10-64-latents_dc-ae-f32c32-sana-1.0) <br/>500 epochs,<br/>BS 896,<br/>1000 timesteps,<br/>LR 5e-4                              | 1x3090, 8hrs    | [Model](https://huggingface.co/g-ronimo/hana-alpha12_cifar10_TS-1000_500e)| [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-12)   | [1.27](https://wandb.ai/g-ronimo/Hana/runs/vi532e54)    ![W B Chart 2_3_2025, 6_53_37 AM](https://github.com/user-attachments/assets/352d6518-49a8-41f7-a3c8-f340b094fe0d)                                                         | ![gallery](https://github.com/user-attachments/assets/4121a573-5a9a-40f5-bbae-61c382fa5f0a) `["airplane", "automobile", "bird", "cat", "deer", "dog", "frog", "horse", "ship", "truck"]`
| Alpha-11    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [CIFAR10 64px](https://huggingface.co/datasets/g-ronimo/CIFAR10-64-latents_dc-ae-f32c32-sana-1.0) <br/>500 epochs,<br/>BS 896,<br/>1000 timesteps,<br/>LR 5e-4                              | 1x3090, 12hrs   | [Model](https://huggingface.co/g-ronimo/hana-alpha11_cifar10_TS-1000_500e)  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-11)   | [1.25](https://wandb.ai/g-ronimo/Hana/runs/uouqka4h)  ![W B Chart 2_2_2025, 9_08_09 AM](https://github.com/user-attachments/assets/2360789e-1d65-481c-9fb6-688625b642bb)                                                        | ![media_images_images_eval_2919_7c7a3df35d986984f8b1 (1)](https://github.com/user-attachments/assets/a5540802-9f0c-4589-8dd5-f2b4dfebcb8c) `["airplane", "automobile", "bird", "cat", "deer", "dog", "frog", "horse", "ship", "truck"]`
| Alpha-17    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (17.8M) `num_layers=7, hidden_dim=384`      | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>20 epochs,<br/>600 steps,<br/>BS 2048,<br/>1000 timesteps (uniform),<br/>LR 5e-4     | 1x3090, 20mins  | [Model](https://huggingface.co/g-ronimo/hana-alpha17)                    | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-17)      | [0.85](https://wandb.ai/g-ronimo/Hana/runs/t0r6wcj6)   ![loss](https://github.com/user-attachments/assets/36938bd3-8eb5-4ac6-9197-10a9dc77c1fc)    ![clipscore](https://github.com/user-attachments/assets/7694bb67-4593-4b88-bb48-a0b54e7e2312) | ![gallery](https://github.com/user-attachments/assets/41dc3725-3c29-4138-bf57-611ef18fa865)
| Alpha-8d    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>400 epochs,<br/>BS 896,<br/>**1000** timesteps                                       | 1x4090, 6.2hrs  | [Model](https://huggingface.co/g-ronimo/hana-small_alpha8_TS-1000_400e)  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8d)      | [1.14](https://github.com/geronimi73/Hana/tree/main/Alpha-8d/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/zosah03p)    ![loss_comparison](https://github.com/user-attachments/assets/0b0abffd-b71d-4daf-99ad-cb16a4f08064)    | ![media_images_images_eval_1463_2941cfe11fbe584e6130](https://github.com/user-attachments/assets/5ad9adb8-5735-4372-a789-58b487ff3ce1) `['T-shirt/top', 'Trouser', 'Pullover', 'Dress', 'Coat', 'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']`
| Alpha-8c    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>236 epochs,<br/>BS 896,<br/>**40** timesteps                                         | 1x4090, 2.6hrs  | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8c)      | [1.33](https://github.com/geronimi73/Hana/tree/main/Alpha-8c/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/btbeqql9)           | ![media_images_images_eval_858_39143ae078839e67f230 (1)](https://github.com/user-attachments/assets/6affe478-1d58-4930-bf57-5efb72e262f6)
| Alpha-8b    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>250 epochs,<br/>BS 896,<br/>**20** timesteps                                         | 1x4090, 2.6hrs  | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8b)      | [1.33](https://github.com/geronimi73/Hana/tree/main/Alpha-8b/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/uddo10fr)           | ![media_images_images_eval_891_65d6f480d656633d9ff8](https://github.com/user-attachments/assets/fde04355-8e74-473b-809f-a2afc2102aa7)
| Alpha-8a    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`                    | [Fashion MNIST](https://huggingface.co/datasets/g-ronimo/FMNIST-latents-64_dc-ae-f32c32-sana-1.0) <br/>250 epochs,<br/>BS 896,<br/>10 timesteps                                             | 1x4090, 2.6hrs  | trashed                                                                  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-8a)      | [1.34](khttps://github.com/geronimi73/Hana/tree/main/Alpha-8a/loss.png) [wandb](https://wandb.ai/g-ronimo/Hana/runs/clwvgpf7)           | ![media_images_images_eval_914_984ebb3d40cd269bf7f2](https://github.com/user-attachments/assets/73962aa2-1ef2-48ce-bbbd-32dfd096d1b0) 
| Alpha-10    | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>3 epochs,<br/>LR 5e-4<br/>BS 256, 10 TS (lognormal)                          | 1x4090, 10'     | [Model](https://huggingface.co/g-ronimo/hana-small_alpha10)              | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-10)      | [1.069](https://wandb.ai/g-ronimo/Hana/runs/ftcxwf3e)        ![loss_TS-lin-vs-logn](https://github.com/user-attachments/assets/b7e92bb6-8083-47fe-9f85-9be21d355ae5)                              | ![media_images_images_eval_41_3599422a42f52634bd6b](https://github.com/user-attachments/assets/83807238-eef6-4c83-b506-d0da868d957c)
| Alpha-7     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>3 epochs,<br/>LR 5e-4,<br/>BS 256, 10 TS                                     | 1x4090, 10'     | [Model](https://huggingface.co/g-ronimo/hana-small_alpha7)               | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-7)       | [0.99](https://wandb.ai/g-ronimo/Hana/runs/clwvgpf7)                                                              | ![media_images_images_eval_41_f15cda102f6f1ed8ee3b](https://github.com/user-attachments/assets/3deee877-710b-432e-b7f7-985384586b94)
| Alpha-9     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [Imagenet-1k](https://huggingface.co/datasets/g-ronimo/Imagenet-256-latents_dc-ae-f32c32-sana-1.0) <br/>60 epochs,<br/>BS 320,<br/>LR 5e-4              | 1x4090, 83hrs   | FAIL                                                                                     | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-9)       | [2.32](https://wandb.ai/g-ronimo/Hana/runs/xiplhjx2)     ![W B Chart 1_31_2025, 3_38_00 PM](https://github.com/user-attachments/assets/39ee7934-39c7-4a8f-ae1b-b7fef2dbec17)     | ![media_images_images_eval_13125_115627eb4d3d574732aa (1)](https://github.com/user-attachments/assets/0e86564d-d8dc-4cf3-a6bd-e75905a78dd6)
| Alpha-5     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [Imagenet-1k](https://huggingface.co/datasets/g-ronimo/Imagenet-256-latents_dc-ae-f32c32-sana-1.0) <br/>20 epochs,<br/>BS 128                           | 1x4090, 22hrs   | FAIL                                                                                     | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-5)       | diverging after e2 [2.57](https://wandb.ai/g-ronimo/Hana/runs/vtpys2tl)       | ![media_images_images_eval_11065_a98b1c9fd31b90e95541](https://github.com/user-attachments/assets/8941d2be-f5e4-4476-8947-b5f909ed41f4)
| Alpha-4     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>3 epochs,<br/>BS 128                                         | 1x4090, 9'      | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-MODERNBERT-3e)  | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-4)       | [1.050](https://wandb.ai/g-ronimo/Hana/runs/c2io87nu)                         | ![media_images_images_eval_76_61a68bef7c70a802ced5](https://github.com/user-attachments/assets/cfd92ec1-d4fe-49c6-9726-0dfe6cb6c8a3)
| Alpha-3     | [ModernBERT-base](https://huggingface.co/answerdotai/ModernBERT-base)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) `num_layers=7`, `cross_attention_dim=1152`            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/>85660 steps,=150 epochs,<br/>BS 128                          | 1x4090, 8 hrs   | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-MODERNBERT)     | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-3)       | [0.833](https://wandb.ai/g-ronimo/Hana/runs/nahswxbq)                         | ![media_images_images_eval_670_f1a015427c67c3e5933e](https://github.com/user-attachments/assets/3bd1dade-69c4-4b52-8725-66fbd3e9dce6)
| Alpha-2     | [Gemma2 2b](https://huggingface.co/google/gemma-2-2b)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) 7 layers instead of 28            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/> 7940 steps,<br/>BS 128                                                                          | 1x4090, 40'     | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-BATCHED)        | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-2)       | [0.933](https://wandb.ai/g-ronimo/Hana/runs/wbxx3k1y)                         | ![images_eval_406_016a491efda29b0ea833](https://github.com/user-attachments/assets/8b367260-3a78-47a0-b6ce-65c95aee78fe)
| Alpha-1     | [Gemma2 2b](https://huggingface.co/google/gemma-2-2b)   | [dc-ae-f32c32-sana-1.0](https://huggingface.co/mit-han-lab/dc-ae-f32c32-sana-1.0-diffusers)         | SanaTransformer2DModel (158.18M) 7 layers instead of 28            | [MNIST](https://huggingface.co/datasets/g-ronimo/MNIST-latents_dc-ae-f32c32-sana-1.0) <br/> 5 epochs,<br/>LR 1e-4,<br/>300k steps,<br/>BS 1                                                 | 1x4090, 4 hours | [Model](https://huggingface.co/g-ronimo/hana-small_MNIST-5e)             | [Code](https://github.com/geronimi73/Hana/tree/main/Alpha-1)       | [0.958](https://wandb.ai/g-ronimo/Hana/runs/zf38z5gx)                         | ![images_eval_15565_b120cf6385fa11612684](https://github.com/user-attachments/assets/96cc0930-47f7-4dfd-aeec-f8f361e75466)



















